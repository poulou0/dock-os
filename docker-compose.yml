version: "2"
services:
  nodejs:
    container_name: dashboard
    build: .
    restart: unless-stopped
    ports:
      - "443:443"
      - "80:80"
    volumes:
      - ".:/app"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    working_dir: /app/src
    command: bash -c "npm install && npm run start"
  filebrowser:
    container_name: filebrowser
    image: "filebrowser/filebrowser"
    restart: unless-stopped
    entrypoint: /filebrowser
    user: "1000:1000"
    command: --port 80 --database /data/database.db --root /srv
    ports:
      - "8000:80"
    volumes:
      - "./plugins/filebrowser:/data"
      - "./media:/srv"
  minidlna:
    container_name: minidlna
    image: "vladgh/minidlna"
    restart: unless-stopped
    network_mode: "host"
    ports:
      - "8200:8200/tcp"
      - "1900:1900/udp"
    volumes:
      - "./media:/media"
    environment:
      MINIDLNA_MEDIA_DIR: /media
      MINIDLNA_FRIENDLY_NAME: custom-nas
      MINIDLNA_INOTIFY: "no"
